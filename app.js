// Application Data
const appData = {
  "blogPosts": [
    {
      "id": 1,
      "title": "Understanding Pottery Shards: A Beginner's Guide",
      "category": "casual",
      "author": "Sarah Martinez",
      "date": "2024-03-15",
      "tags": ["pottery", "beginners", "ceramics", "analysis"],
      "excerpt": "Discover how archaeologists use pottery fragments to unlock secrets of ancient civilizations. This beginner-friendly guide covers basic identification techniques.",
      "content": "Pottery shards, or sherds as archaeologists call them, are among the most common artifacts found at archaeological sites. These ceramic fragments provide invaluable insights into past cultures, revealing information about daily life, trade networks, technological advances, and artistic traditions.\n\nWhen examining pottery shards, archaeologists look for several key features:\n\n**Temper and Fabric**: The materials added to clay to prevent cracking during firing. Common tempers include sand, crushed rock, or organic materials like grass.\n\n**Surface Treatment**: How the pot was finished - smooth, textured, painted, or glazed. This can indicate cultural preferences and technological capabilities.\n\n**Form and Function**: The shape of the original vessel can tell us about its use - storage, cooking, serving, or ritual purposes.\n\n**Decoration**: Painted designs, incised patterns, or applied elements that may have cultural or symbolic significance.\n\nFor beginners, start by observing these basic characteristics. Take detailed notes and photographs, and always work with experienced archaeologists when handling artifacts. Remember, every shard has a story to tell about the people who made and used it thousands of years ago.",
      "language": "en",
      "readTime": "5 min"
    },
    {
      "id": 2,
      "title": "Stratigraphic Analysis in Urban Excavations: Methodological Approaches",
      "category": "academic",
      "author": "Dr. James Wilson",
      "date": "2024-03-10",
      "tags": ["stratigraphy", "urban archaeology", "methodology", "excavation"],
      "excerpt": "This paper examines advanced stratigraphic recording techniques for complex urban archaeological contexts, with case studies from recent European excavations.",
      "content": "Stratigraphic analysis in urban contexts presents unique challenges that require sophisticated methodological approaches. The complexity of urban archaeological sites, characterized by centuries of continuous occupation, demolition, and reconstruction, demands rigorous recording and interpretative frameworks.\n\n**Abstract**\nThis paper presents an integrated approach to stratigraphic recording in urban archaeological contexts, incorporating digital documentation methods with traditional Harris Matrix principles. Case studies from recent excavations in London, Rome, and Barcelona demonstrate the effectiveness of these methodologies in complex urban environments.\n\n**Introduction**\nUrban archaeology has evolved significantly over the past three decades, driven by both theoretical advances and technological innovations. The stratigraphic method, first systematized by Edward Harris in the 1970s, remains fundamental to archaeological interpretation. However, urban contexts require adaptations to accommodate the complexity of multi-period sites with extensive disturbance and truncation.\n\n**Methodology**\nOur approach integrates several key components:\n\n1. **Single Context Recording**: Each stratigraphic unit is recorded individually with detailed context sheets\n2. **Digital Documentation**: 3D photogrammetry and GIS integration for spatial analysis\n3. **Matrix Construction**: Real-time Harris Matrix development using specialized software\n4. **Multi-scalar Analysis**: Integration of micro-stratigraphic and site-wide interpretations\n\n**Case Studies**\nThree urban excavations demonstrate the application of these methods:\n\n- **Crossrail Project, London**: Medieval to post-medieval sequences\n- **Crypta Balbi, Rome**: Late antique to medieval transformations  \n- **Born Market, Barcelona**: 18th-19th century urban development\n\n**Conclusions**\nThe integration of digital methods with established stratigraphic principles enhances both recording accuracy and interpretative potential in urban archaeological contexts. Future research should focus on developing standardized protocols for multi-site comparative analysis.",
      "language": "en",
      "readTime": "15 min"
    },
    {
      "id": 3,
      "title": "Digital Documentation Tools for Field Archaeology",
      "category": "academic",
      "author": "Dr. Elena Rodriguez",
      "date": "2024-03-08",
      "tags": ["digital archaeology", "documentation", "GIS", "technology"],
      "excerpt": "Comprehensive review of digital tools and platforms for archaeological documentation, including GIS applications and 3D modeling techniques.",
      "content": "The integration of digital technologies in archaeological fieldwork has revolutionized documentation practices, offering unprecedented precision and analytical capabilities. This review examines current digital tools and methodologies, evaluating their applications, benefits, and limitations in contemporary field archaeology.\n\n**Digital Documentation Landscape**\nModern archaeological projects increasingly rely on digital tools for data collection, analysis, and dissemination. These technologies range from simple tablet-based recording systems to sophisticated 3D modeling and virtual reality applications.\n\n**Core Technologies**\n\n**1. Geographic Information Systems (GIS)**\n- Spatial data management and analysis\n- Integration of excavation data with landscape context\n- Real-time mapping and GPS integration\n- Popular platforms: ArcGIS, QGIS, ArcGIS Online\n\n**2. 3D Documentation**\n- Photogrammetry for artifact and feature recording\n- Laser scanning for site documentation\n- Structure from Motion (SfM) techniques\n- Integration with CAD and modeling software\n\n**3. Database Management**\n- Relational databases for artifact and context data\n- Cloud-based systems for team collaboration\n- Mobile data collection applications\n- Standards compliance (e.g., CIDOC-CRM)\n\n**4. Digital Drawing and CAD**\n- Technical illustration and plan drawing\n- 3D modeling and reconstruction\n- Integration with field data\n\n**Best Practices**\n- Establish data standards early in the project\n- Ensure regular backup and version control\n- Train all team members in digital workflows\n- Plan for long-term data preservation\n- Consider interoperability between systems\n\n**Future Directions**\nEmerging technologies such as machine learning, augmented reality, and blockchain offer new possibilities for archaeological documentation. However, successful implementation requires careful consideration of cost, training requirements, and long-term sustainability.",
      "language": "en",
      "readTime": "12 min"
    },
    {
      "id": 4,
      "title": "Cooking in Ancient Rome: What Pots Tell Us",
      "category": "casual", 
      "author": "Marcus Thompson",
      "date": "2024-03-05",
      "tags": ["Roman archaeology", "daily life", "cooking", "artifacts"],
      "excerpt": "Explore how ancient Roman cooking vessels reveal dietary habits, social structures, and daily life in the empire.",
      "content": "When we examine Roman cooking pots and kitchen utensils, we're getting a glimpse into the daily lives of people who lived 2000 years ago. These humble artifacts tell fascinating stories about what Romans ate, how they prepared their food, and even their social status.\n\n**The Roman Kitchen**\nRoman kitchens varied dramatically depending on social class. Wealthy households had elaborate kitchens with multiple hearths, while ordinary citizens might cook over a simple brazier. Archaeological evidence from Pompeii and Herculaneum gives us remarkable insights into these spaces.\n\n**Common Cooking Vessels**\n\n**Olla**: Large storage jars for grain, oil, and wine. The size and quality could indicate a family's wealth.\n\n**Patina**: Shallow pans similar to modern frying pans, used for cooking eggs, fish, and vegetables.\n\n**Cacabus**: Deep cooking pots with rounded bottoms, perfect for stews and porridge.\n\n**Mortarium**: Heavy bowls with gritty surfaces for grinding spices and making sauces.\n\n**What They Ate**\nCooking pots reveal that Romans had a varied diet. Wealthy Romans enjoyed exotic spices, imported fish sauces, and elaborate dishes. Common people ate simpler fare - porridge, bread, vegetables, and occasional meat.\n\nFood residue analysis on pottery has revealed traces of olive oil, wine, fish sauce (garum), and various grains. Some pots even show evidence of repeated use for the same types of foods.\n\n**Social Indicators**\nThe quality and decoration of cooking vessels reflected social status. Fine pottery with decorative elements belonged to wealthy households, while simple, utilitarian pieces were used by ordinary citizens.\n\nInterestingly, some cooking pots show evidence of repair - patches and clamps that kept cracked vessels usable. This suggests that even common pottery was valued and maintained, reflecting the economic realities of daily life.\n\n**Conclusion**\nRoman cooking pots are more than just ancient kitchenware - they're windows into the past that help us understand how people lived, what they valued, and how they adapted to their world. Every shard tells a story of daily life in one of history's greatest civilizations.",
      "language": "en",
      "readTime": "7 min"
    }
  ],
  "resources": [
    {
      "id": 1,
      "title": "Harris Matrix Composer",
      "type": "Software Tool",
      "region": "Global",
      "studySection": "Stratigraphy",
      "description": "Digital tool for creating and managing stratigraphic sequences using the Harris Matrix methodology.",
      "url": "#",
      "tags": ["stratigraphy", "digital tools", "excavation"],
      "author": "ArcheoTech Solutions",
      "dateAdded": "2024-02-20"
    },
    {
      "id": 2,
      "title": "Mediterranean Ceramics Database",
      "type": "Database",
      "region": "Mediterranean",
      "studySection": "Ceramics",
      "description": "Comprehensive database of Mediterranean ceramic traditions from Bronze Age to Byzantine period.",
      "url": "#",
      "tags": ["ceramics", "database", "Mediterranean", "pottery"],
      "author": "Mediterranean Archaeology Consortium",
      "dateAdded": "2024-02-18"
    },
    {
      "id": 3,
      "title": "Radiocarbon Dating Guidelines",
      "type": "Research Paper",
      "region": "Global",
      "studySection": "Dating Methods",
      "description": "Best practices and methodological guidelines for collecting and interpreting radiocarbon dates in archaeology.",
      "url": "#",
      "tags": ["radiocarbon", "dating", "methodology"],
      "author": "International Dating Standards Committee",
      "dateAdded": "2024-02-15"
    },
    {
      "id": 4,
      "title": "African Iron Age Site Reports",
      "type": "Archive",
      "region": "Africa",
      "studySection": "Iron Age",
      "description": "Collection of excavation reports from Iron Age sites across sub-Saharan Africa.",
      "url": "#",
      "tags": ["Iron Age", "Africa", "excavation reports"],
      "author": "African Archaeology Network",
      "dateAdded": "2024-02-12"
    },
    {
      "id": 5,
      "title": "Bone Analysis Toolkit",
      "type": "Educational Material",
      "region": "Global", 
      "studySection": "Bioarchaeology",
      "description": "Interactive educational materials for learning human and animal bone identification and analysis techniques.",
      "url": "#",
      "tags": ["bioarchaeology", "bones", "education", "identification"],
      "author": "University Archaeology Departments",
      "dateAdded": "2024-02-10"
    }
  ],
  "languages": {
    "en": "English",
    "es": "Español", 
    "fr": "Français",
    "de": "Deutsch",
    "ar": "العربية"
  },
  "translations": {
    "en": {
      "nav": {
        "home": "Home",
        "blog": "Blog", 
        "resources": "Resources",
        "about": "About",
        "community": "Community",
        "login": "Login",
        "register": "Register"
      },
      "homepage": {
        "hero_title": "ArcANE: Archaeology for Everyone",
        "hero_subtitle": "Accessibility, Networking, Engagement",
        "hero_description": "An open-access platform connecting archaeology professionals, students, and enthusiasts worldwide. Discover resources, share knowledge, and build community.",
        "featured_posts": "Featured Posts",
        "featured_resources": "Featured Resources",
        "join_community": "Join Our Community"
      },
      "blog": {
        "title": "Blog",
        "casual": "Casual",
        "academic": "Academic", 
        "search_placeholder": "Search posts...",
        "filter_by_tags": "Filter by tags",
        "read_more": "Read More"
      },
      "resources": {
        "title": "Resource Pool",
        "sort_by": "Sort by",
        "alphabetical": "Alphabetical",
        "region": "Region", 
        "study_section": "Study Section",
        "search_placeholder": "Search resources...",
        "filter_by_type": "Filter by type"
      }
    },
    "es": {
      "nav": {
        "home": "Inicio",
        "blog": "Blog",
        "resources": "Recursos", 
        "about": "Acerca de",
        "community": "Comunidad",
        "login": "Iniciar sesión",
        "register": "Registrarse"
      },
      "homepage": {
        "hero_title": "ArcANE: Arqueología para Todos",
        "hero_subtitle": "Accesibilidad, Redes, Participación",
        "hero_description": "Una plataforma de acceso abierto que conecta profesionales, estudiantes y entusiastas de la arqueología en todo el mundo.",
        "featured_posts": "Publicaciones Destacadas",
        "featured_resources": "Recursos Destacados",
        "join_community": "Únete a Nuestra Comunidad"
      },
      "blog": {
        "title": "Blog",
        "casual": "Casual",
        "academic": "Académico", 
        "search_placeholder": "Buscar publicaciones...",
        "filter_by_tags": "Filtrar por etiquetas",
        "read_more": "Leer Más"
      },
      "resources": {
        "title": "Banco de Recursos",
        "sort_by": "Ordenar por",
        "alphabetical": "Alfabético",
        "region": "Región", 
        "study_section": "Sección de Estudio",
        "search_placeholder": "Buscar recursos...",
        "filter_by_type": "Filtrar por tipo"
      }
    }
  }
};

// Application State
let currentLanguage = 'en';
let currentSection = 'home';
let filteredPosts = [...appData.blogPosts];
let filteredResources = [...appData.resources];
let selectedTags = [];
let selectedTypes = [];
let selectedRegions = [];

// DOM Elements
const navLinks = document.querySelectorAll('.nav__link');
const sections = document.querySelectorAll('.section');
const navToggle = document.querySelector('.nav__toggle');
const navMenu = document.querySelector('.nav__menu');
const languageSwitcher = document.querySelector('.language-switcher');
const modal = document.getElementById('postModal');

// Initialize Application
document.addEventListener('DOMContentLoaded', function() {
    initializeNavigation();
    initializeLanguageSwitcher();
    initializeBlog();
    initializeResources();
    initializeAuth();
    initializeModal();
    populateFeaturedContent();
    translatePage();
});

// Navigation
function initializeNavigation() {
    // Handle navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetSection = link.getAttribute('href').substring(1);
            showSection(targetSection);
            updateActiveNavLink(link);
            
            // Close mobile menu if open
            navMenu.classList.remove('active');
        });
    });
    
    // Mobile menu toggle
    navToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
        const isExpanded = navMenu.classList.contains('active');
        navToggle.setAttribute('aria-expanded', isExpanded);
    });
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', (e) => {
        if (!navToggle.contains(e.target) && !navMenu.contains(e.target)) {
            navMenu.classList.remove('active');
            navToggle.setAttribute('aria-expanded', 'false');
        }
    });
}

function showSection(sectionId) {
    sections.forEach(section => {
        section.classList.add('hidden');
    });
    
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.remove('hidden');
        currentSection = sectionId;
    }
}

function updateActiveNavLink(activeLink) {
    navLinks.forEach(link => link.classList.remove('active'));
    activeLink.classList.add('active');
}

// Language Switching
function initializeLanguageSwitcher() {
    languageSwitcher.addEventListener('change', (e) => {
        currentLanguage = e.target.value;
        translatePage();
    });
}

function translatePage() {
    const translations = appData.translations[currentLanguage] || appData.translations.en;
    
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        const translation = getNestedTranslation(translations, key);
        if (translation) {
            element.textContent = translation;
        }
    });
    
    document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        const translation = getNestedTranslation(translations, key);
        if (translation) {
            element.placeholder = translation;
        }
    });
}

function getNestedTranslation(obj, key) {
    return key.split('.').reduce((o, k) => o && o[k], obj);
}

// Blog Functionality
function initializeBlog() {
    // Category filters
    const categoryButtons = document.querySelectorAll('[data-category]');
    categoryButtons.forEach(button => {
        button.addEventListener('click', () => {
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            filterPostsByCategory(button.dataset.category);
        });
    });
    
    // Search functionality
    const blogSearch = document.getElementById('blogSearch');
    blogSearch.addEventListener('input', (e) => {
        filterPostsBySearch(e.target.value);
    });
    
    // Populate tags
    populateTagFilter();
    renderBlogPosts();
}

function populateTagFilter() {
    const allTags = [...new Set(appData.blogPosts.flatMap(post => post.tags))];
    const tagFilter = document.getElementById('tagFilter');
    
    tagFilter.innerHTML = allTags.map(tag => `
        <div class="tag-item">
            <input type="checkbox" id="tag-${tag}" value="${tag}">
            <label for="tag-${tag}">${tag}</label>
        </div>
    `).join('');
    
    // Add event listeners to tag checkboxes
    tagFilter.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
            if (e.target.checked) {
                selectedTags.push(e.target.value);
            } else {
                selectedTags = selectedTags.filter(tag => tag !== e.target.value);
            }
            filterPosts();
        });
    });
}

function filterPostsByCategory(category) {
    if (category === 'all') {
        filteredPosts = [...appData.blogPosts];
    } else {
        filteredPosts = appData.blogPosts.filter(post => post.category === category);
    }
    renderBlogPosts();
}

function filterPostsBySearch(searchTerm) {
    const term = searchTerm.toLowerCase();
    filteredPosts = appData.blogPosts.filter(post => 
        post.title.toLowerCase().includes(term) ||
        post.excerpt.toLowerCase().includes(term) ||
        post.author.toLowerCase().includes(term) ||
        post.tags.some(tag => tag.toLowerCase().includes(term))
    );
    renderBlogPosts();
}

function filterPosts() {
    filteredPosts = appData.blogPosts.filter(post => {
        if (selectedTags.length > 0) {
            return selectedTags.some(tag => post.tags.includes(tag));
        }
        return true;
    });
    renderBlogPosts();
}

function renderBlogPosts() {
    const postsGrid = document.getElementById('postsGrid');
    
    postsGrid.innerHTML = filteredPosts.map(post => `
        <article class="post-card" data-post-id="${post.id}">
            <header class="post-card__header">
                <span class="post-card__category post-card__category--${post.category}">${post.category}</span>
                <h3 class="post-card__title">${post.title}</h3>
                <div class="post-card__meta">
                    <span>By ${post.author}</span>
                    <span>${formatDate(post.date)}</span>
                    <span>${post.readTime}</span>
                </div>
            </header>
            <div class="post-card__body">
                <p class="post-card__excerpt">${post.excerpt}</p>
                <div class="post-card__tags">
                    ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                </div>
            </div>
        </article>
    `).join('');
    
    // Add click listeners to post cards
    postsGrid.querySelectorAll('.post-card').forEach(card => {
        card.addEventListener('click', () => {
            const postId = parseInt(card.dataset.postId);
            openPostModal(postId);
        });
    });
}

// Resources Functionality
function initializeResources() {
    // Sort functionality
    const sortBy = document.getElementById('sortBy');
    sortBy.addEventListener('change', (e) => {
        sortResources(e.target.value);
    });
    
    // Search functionality
    const resourceSearch = document.getElementById('resourceSearch');
    resourceSearch.addEventListener('input', (e) => {
        filterResourcesBySearch(e.target.value);
    });
    
    // Populate filters
    populateResourceFilters();
    renderResources();
}

function populateResourceFilters() {
    // Type filter
    const allTypes = [...new Set(appData.resources.map(resource => resource.type))];
    const typeFilter = document.getElementById('typeFilter');
    
    typeFilter.innerHTML = allTypes.map(type => `
        <div class="filter-item">
            <input type="checkbox" id="type-${type.replace(/\s+/g, '-')}" value="${type}">
            <label for="type-${type.replace(/\s+/g, '-')}">${type}</label>
        </div>
    `).join('');
    
    // Region filter
    const allRegions = [...new Set(appData.resources.map(resource => resource.region))];
    const regionFilter = document.getElementById('regionFilter');
    
    regionFilter.innerHTML = allRegions.map(region => `
        <div class="filter-item">
            <input type="checkbox" id="region-${region.replace(/\s+/g, '-')}" value="${region}">
            <label for="region-${region.replace(/\s+/g, '-')}">${region}</label>
        </div>
    `).join('');
    
    // Add event listeners
    typeFilter.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
            if (e.target.checked) {
                selectedTypes.push(e.target.value);
            } else {
                selectedTypes = selectedTypes.filter(type => type !== e.target.value);
            }
            filterResources();
        });
    });
    
    regionFilter.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
            if (e.target.checked) {
                selectedRegions.push(e.target.value);
            } else {
                selectedRegions = selectedRegions.filter(region => region !== e.target.value);
            }
            filterResources();
        });
    });
}

function sortResources(sortBy) {
    filteredResources.sort((a, b) => {
        switch (sortBy) {
            case 'alphabetical':
                return a.title.localeCompare(b.title);
            case 'region':
                return a.region.localeCompare(b.region);
            case 'studySection':
                return a.studySection.localeCompare(b.studySection);
            case 'dateAdded':
                return new Date(b.dateAdded) - new Date(a.dateAdded);
            default:
                return 0;
        }
    });
    renderResources();
}

function filterResourcesBySearch(searchTerm) {
    const term = searchTerm.toLowerCase();
    filteredResources = appData.resources.filter(resource => 
        resource.title.toLowerCase().includes(term) ||
        resource.description.toLowerCase().includes(term) ||
        resource.author.toLowerCase().includes(term) ||
        resource.tags.some(tag => tag.toLowerCase().includes(term))
    );
    renderResources();
}

function filterResources() {
    filteredResources = appData.resources.filter(resource => {
        const typeMatch = selectedTypes.length === 0 || selectedTypes.includes(resource.type);
        const regionMatch = selectedRegions.length === 0 || selectedRegions.includes(resource.region);
        return typeMatch && regionMatch;
    });
    renderResources();
}

function renderResources() {
    const resourcesGrid = document.getElementById('resourcesGrid');
    
    resourcesGrid.innerHTML = filteredResources.map(resource => `
        <article class="resource-card">
            <header class="resource-card__header">
                <span class="resource-card__type">${resource.type}</span>
                <h3 class="resource-card__title">${resource.title}</h3>
                <div class="resource-card__meta">
                    <div>Region: ${resource.region}</div>
                    <div>Study Section: ${resource.studySection}</div>
                    <div>Author: ${resource.author}</div>
                </div>
            </header>
            <div class="resource-card__body">
                <p class="resource-card__description">${resource.description}</p>
            </div>
            <footer class="resource-card__footer">
                <div class="resource-card__tags">
                    ${resource.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                </div>
                <button class="btn btn--primary btn--sm">Access Resource</button>
            </footer>
        </article>
    `).join('');
}

// Authentication
function initializeAuth() {
    const authTabs = document.querySelectorAll('.auth-tab');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    
    authTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            authTabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            if (tab.dataset.tab === 'login') {
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
            } else {
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
            }
        });
    });
    
    // Form submissions
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        handleLogin();
    });
    
    registerForm.addEventListener('submit', (e) => {
        e.preventDefault();
        handleRegister();
    });
}

function handleLogin() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    // Simulate login
    if (email && password) {
        alert('Login successful! Welcome to ArcANE.');
        document.getElementById('loginForm').reset();
    }
}

function handleRegister() {
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    const role = document.getElementById('registerRole').value;
    
    // Simulate registration
    if (name && email && password && role) {
        alert('Registration successful! Welcome to the ArcANE community.');
        document.getElementById('registerForm').reset();
    }
}

// Modal Functionality
function initializeModal() {
    const modalClose = modal.querySelector('.modal__close');
    const modalBackdrop = modal.querySelector('.modal__backdrop');
    
    modalClose.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', closeModal);
    
    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
            closeModal();
        }
    });
}

function openPostModal(postId) {
    const post = appData.blogPosts.find(p => p.id === postId);
    if (!post) return;
    
    const modalTitle = modal.querySelector('#postModalTitle');
    const modalBody = modal.querySelector('#postModalBody');
    
    modalTitle.textContent = post.title;
    modalBody.innerHTML = `
        <div class="post-meta">
            <span class="post-category post-card__category--${post.category}">${post.category}</span>
            <div class="post-info">
                <span>By ${post.author}</span>
                <span>${formatDate(post.date)}</span>
                <span>${post.readTime}</span>
            </div>
        </div>
        <div class="post-content">
            ${post.content.split('\n').map(paragraph => 
                paragraph.trim() ? `<p>${paragraph.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</p>` : ''
            ).join('')}
        </div>
        <div class="post-tags">
            ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
        </div>
    `;
    
    modal.classList.remove('hidden');
    modal.setAttribute('aria-hidden', 'false');
    modalTitle.focus();
}

function closeModal() {
    modal.classList.add('hidden');
    modal.setAttribute('aria-hidden', 'true');
}

// Featured Content
function populateFeaturedContent() {
    // Featured posts (first 2 posts)
    const featuredPosts = appData.blogPosts.slice(0, 2);
    const featuredPostsContainer = document.getElementById('featuredPosts');
    
    featuredPostsContainer.innerHTML = featuredPosts.map(post => `
        <article class="post-card" data-post-id="${post.id}">
            <header class="post-card__header">
                <span class="post-card__category post-card__category--${post.category}">${post.category}</span>
                <h4 class="post-card__title">${post.title}</h4>
                <div class="post-card__meta">
                    <span>${post.author}</span>
                    <span>${post.readTime}</span>
                </div>
            </header>
            <div class="post-card__body">
                <p class="post-card__excerpt">${post.excerpt.substring(0, 100)}...</p>
            </div>
        </article>
    `).join('');
    
    // Featured resources (first 2 resources)
    const featuredResources = appData.resources.slice(0, 2);
    const featuredResourcesContainer = document.getElementById('featuredResources');
    
    featuredResourcesContainer.innerHTML = featuredResources.map(resource => `
        <article class="resource-card">
            <header class="resource-card__header">
                <span class="resource-card__type">${resource.type}</span>
                <h4 class="resource-card__title">${resource.title}</h4>
            </header>
            <div class="resource-card__body">
                <p class="resource-card__description">${resource.description.substring(0, 100)}...</p>
            </div>
        </article>
    `).join('');
    
    // Add click listeners to featured posts
    featuredPostsContainer.querySelectorAll('.post-card').forEach(card => {
        card.addEventListener('click', () => {
            const postId = parseInt(card.dataset.postId);
            openPostModal(postId);
        });
    });
}

// Utility Functions
function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
}

// Quick navigation buttons
document.addEventListener('click', (e) => {
    if (e.target.matches('a[href^="#"]')) {
        e.preventDefault();
        const targetId = e.target.getAttribute('href').substring(1);
        const targetSection = document.getElementById(targetId);
        
        if (targetSection) {
            showSection(targetId);
            
            // Update active nav link
            const correspondingNavLink = document.querySelector(`.nav__link[href="#${targetId}"]`);
            if (correspondingNavLink) {
                updateActiveNavLink(correspondingNavLink);
            }
        }
    }
});